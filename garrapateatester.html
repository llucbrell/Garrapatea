<!doctype html>

<html>

<head>
<meta charset="utf-8">
<script src="libs/vexflow-min.js"></script>
<script src="libs/jquery.js"></script>
<script src="libs/garrapatea/nuevocompas.js"></script>
<script src="libs/garrapatea/nuevaclave.js"></script>
<script src="libs/garrapatea/nuevoritmo.js"></script>
<script src="libs/garrapatea/controlbotones.js"></script>
<script src="libs/garrapatea/coordenadasratoncanvas.js"></script>
<script src="libs/garrapatea/nuevanota.js"></script>
<script src="libs/garrapatea/nuevosilencio.js"></script>
<script src="libs/garrapatea/nuevabarra.js"></script>
<script src="libs/garrapatea/redibujacanvas.js"></script>
<script src="libs/garrapatea/almacena.js"></script>
<script src="libs/garrapatea/armadura.js"></script>
<script src="libs/garrapatea/imprimir.js"></script>
<script src="libs/garrapatea/preview.js"></script>
<!--note control interface for send to the correct livesound API-->
<script src="libs/garrapatea/sonido.js"></script>
<script src="libs/garrapatea/loadaudio.js"></script>
<script src="libs/garrapatea/browsers.js"></script>
<script src="libs/garrapatea/loadaudioie.js"></script>
<!--Midi transaltion library control-->
<script src="libs/MidiSketch.js"></script>
<script src="libs/garrapatea/interfacemidi.js"></script>
<!--Midi online reproduction library control-->
<script src="libs/garrapatea/leemidi.js"></script>
<script src="libs/garrapatea/synth.js"></script>
<script src="libs/garrapatea/audio.js"></script>
<script src="libs/garrapatea/replayer.js"></script>
<script src="libs/garrapatea/playonflight.js"></script>


<style type="text/css">
/*
*{
  margin: 0;
  padding: 0;
  border: none;
}

#partitura{
  margin-left: 4px;
}

#c0{
   margin-right: -2px;
}


#b0{
  
  margin-left: 35px;
  margin-right: -2px;
}

*/

.clave{
  margin-left: -2px;
  margin-right: -2px;
}
.ritmo{
  margin-left: -2px;
  margin-right: -2px;
  }



canvas {
  position: relative;
  display: inline-block;
  padding: 0px;
  margin-left: -2px;
  }


</style>

</head>
<body >
<header>
<h1>Garrapatea</h1> 
</header>
<h2 contenteditable="true" id="titulo">Titulo</h2> 
<div id="partitura">
  <!--
<canvas width="1" height="150" id="b0" class="barra"></canvas>podemos usar un sistema de barrado para formatear todo mejor -->



</div>
<div>

<label>
<input type="checkbox" name="sonido" id="sonido" checked="checked"> 
sonido
</label>

<button id="1" class="botones">+</button>
<button id="2" class="botones">-</button>
<button id="3" class="botones">Print</button>
<button id="4" class="botones">PNG</button>
<button id="5" class="botones">Midi</button>
<button id="6" class="botones">Play</button>


<div>
<form name="controles">
<label class="radio" for="option1">

  <input type="radio" name="radioButtons" id="option1" value="notas" checked="checked">

  Notas
  
</label>

<label class="radio" for="option2">

  <input type="radio" name="radioButtons" id="option2" value="claves" >

  Claves
 
</label>
  
  <label class="radio" for="option3">

  <input type="radio" name="radioButtons" id="option3" value="ritmos" >

  Ritmos

</label>

<label class="radio" for="option4">

  <input type="radio" name="radioButtons" id="option4" value="silencios" >

  Silencios

</label>

<label class="radio" for="option5">

  <input type="radio" name="radioButtons" id="option5" value="barra" >

  Barrado

</label>

<label>
  
  <input type="radio" name="radioButtons" id="armadura" value="armadura"> 

  Armadura

</label>


<label>
  
  <input type="checkbox" name="alteraciones" id="alteraciones"> 

  Alteraciones

</label>

<label>
<input type="checkbox" name="puntillo" id="puntillo"> 
puntillo
</label>


</form>
</div>

<div id="desplegable">
<form id="notasform">
<label class="radio2" for="redonda">
<input type="radio" name="notas" id="redonda" value="1">
redonda</label>
<label class="radio2" for="blanca">
<input type="radio" name="notas" id="blanca" value="2" checked="checked">blanca</label>
<label class="radio2" for="negra">
<input type="radio" name="notas" id="negra" value="4">
negra</label>
<label class="radio2" for="corchea">
<input type="radio" name="notas" id="corchea" value="8">
corchea</label>
<label class="radio2" for="semicorchea">
<input type="radio" name="notas" id="semicorchea" value="16">
semicorche</label>
<label class="radio2" for="fusa">
<input type="radio" name="notas" id="fusa" value="32">
fusa</label>
<label class="radio2" for="semifusa">
<input type="radio" name="notas" id="semifusa" value="64">
semifusa</label>
<label class="radio2" for="garrapatea">
<input type="radio" name="notas" id="garrapatea" value="128">
garrapatea</label>
</form>


<form id="accidentesform">
<label class="radio6" for="becuadro">
<input type="radio" name="accidentes" id="becuadro" value="n" checked="checked">
becuadr</label>
<label class="radio6" for="sostenido">
<input type="radio" name="accidentes" id="sostenido" value="#">
sostenido</label>
<label class="radio6" for="bemol">
<input type="radio" name="accidentes" id="bemol" value="b">
bemol</label>
<label class="radio6" for="dsostenido">
<input type="radio" name="accidentes" id="dsostenido" value="##">
dsostenido</label>
<label class="radio6" for="dbemol">
<input type="radio" name="accidentes" id="dbemol" value="bb">
dbemol</label>
</form>



<label class="agruparadios" for="option2">
<form id="clavesform">
<label class="radio4" for="clavesol">
<input type="radio" name="claves" id="clavesol" value="treble" checked="checked">
sol2</label>
<label class="radio4" for="clavefa">
<input type="radio" name="claves" id="clavefa" value="bass">
fa4</label>
<label class="radio4" for="clavedo">
<input type="radio" name="claves" id="clavedo" value="alto">
do3</label>
</form></label>



<label class="agruparadios" for="option3">
<form id="ritmosform">
<label class="radio3" for="2/4">
<input type="radio" name="ritmos" id="2/4" value="2/4">
2/4</label>
<label class="radio3" for="3/4">
 <input type="radio" name="ritmos" id="3/4" value="3/4" checked="checked">
3/4</label>
<label class="radio3" for="4/4">
 <input type="radio" name="ritmos" id="4/4" value="4/4">
4/4</label>
<label class="radio3" for="6/8">
 <input type="radio" name="ritmos" id="6/8" value="6/8">
6/8</label>
<label class="radio3" for="9/8">
 <input type="radio" name="ritmos" id="9/8" value="9/8">
9/8</label>
<label class="radio3" for="12/8">
 <input type="radio" name="ritmos" id="12/8" value="12/8">
12/8</label>
</form></label>


<label class="agruparadios" for="option5">
<form id="barrasform">
<label class="radio5" for="barranormal">
<input type="radio" name="barras" id="barranormal" value="barranormal" checked="checked">
bnormal</label>
<label class="radio5" for="barradoble">
 <input type="radio" name="barras" id="barradoble" value="barradoble">
bdoble</label>
<label class="radio5" for="barrafinal">
 <input type="radio" name="barras" id="barrafinal" value="barrafinal">
bfinal</label>
<label class="radio5" for="barrarepeticionprin">
 <input type="radio" name="barras" id="barrarepeticionprin" value="barrarepeticionprin">
brepini</label>
<label class="radio5" for="barrarepeticionend">
 <input type="radio" name="barras" id="barrarepeticionend" value="barrarepeticionend">
brepend</label>
</form>
</label> 


</div>

<!--
<div id="dibujo"><canvas width="200" height="220" id="d0" class="dibujable"></canvas>
<canvas width="200" height="220" id="d1" class="dibujable"></canvas>
</div><button id="clear">clear</button>
-->

<canvas id="preview"></canvas>
<div id="visual"></div>

<script type="text/javascript">

//la mayor parte de esto lo controlará el bloguero
//contador de compases/stave counter
var numerocompas=0;
var canvas_y;
var canvas_x;
//almacén de objetos (notas, claves, etc.,)
var almacen=[];
var contador=0;
var arraymp3s=[];

//control del tamaño del vex/vex stave size control
var valinivexstave=-1;
var valaltvexstave=20;
var valfinvexstave=39;
//var accion="notas";


//control localización barras
var valinivexbar=0;
var valaltvexbar=20;
var valfinvexbar=38;
//for audio playing
var jasmid;

//for midi file writting
var midisketch= new MidiObject();
var track= new MidiTrack();


//compás inicial para una mejor experiéncia UI 
//se puede mejorar, colocar todo en una función a parte

nuevoCanvas();
nuevoCanvas();
nuevaClave("treble", "c0");
nuevoRitmo("6/8", "c1");
nuevaBarra("2","c0")
//usamos esta función para cargar el audio
//loadAudio();


//ONCLICK LISTENERS

$("#1").on("click", function(){
    nuevoCanvas();
});

$("#2").on("click", function(){
    borraCanvasDom();
});

$("#3").on("click", function(){
    imprimirPartitura();
});

$("#4").on("click", function(){
    muestraImagenPartitura();
});

$("#5").on("click", function(){
    aMidi(almacen);
    aFile();
});

$("#6").on("click", function(){
    aMidi(almacen);
    aReproducir(midisketch);      
});



window.addEventListener('load', browserCatch, false);

//audioSupport





  </script>







 
</div>

<div id="audio" style="visibility:hidden;"></div>
<div id="miditexto"></canvas>

  <div id="explorermiditag"></div>



</body>
  
</html>